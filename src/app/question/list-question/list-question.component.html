<p-toast></p-toast>
<p-confirmdialog></p-confirmdialog>

<app-sidebar-drawer></app-sidebar-drawer>

<div class="p-4 surface-ground transition-all">
  <div class="max-w-screen-xl mx-auto">

    <div class="flex items-center justify-between mb-4 w-full">
      <h2 class="text-2xl font-semibold text-900">Quest√µes</h2>
      <div class="flex items-end gap-4">
        <div class="col-span-1 md:col-span-1">
          <p-select [options]="categories" [(ngModel)]="selectedSubject" optionLabel="name" placeholder="Disciplina"
            (onChange)="onFilterChange()" class="w-full md:w-auto" />
        </div>
        <div class="col-span-1 md:col-span-1">
          <p-select [options]="difficulties" [(ngModel)]="selectedDifficulty" optionLabel="name"
            placeholder="Dificuldade" (onChange)="onFilterChange()" class="w-full md:w-auto" />
        </div>
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      @for (question of filteredQuestions; track question.id) {

      <div
        class="surface-card p-4 border-round shadow-2 hover:shadow-4 transition-all duration-300 border border-gray-500 rounded-md">
        <div class="flex items-center justify-between mb-2">
          <h3 class="text-xl font-semibold text-900">{{ question.text }}</h3>
          <div class="flex gap-2">
            <button pButton type="button" icon="pi pi-eye" class="p-button-rounded p-button-text p-button-sm"
              (click)="viewQuestion(question.id)" pTooltip="Visualizar" tooltipPosition="top"></button>

            <button pButton type="button" icon="pi pi-pencil" class="p-button-rounded p-button-text p-button-sm"
              (click)="editQuestion(question.id)" pTooltip="Editar" tooltipPosition="top"></button>

            <button pButton type="button" icon="pi pi-trash"
              class="p-button-rounded p-button-text p-button-sm p-button-danger"
              (click)="question.id && deleteQuestion(question.id)" pTooltip="Excluir" tooltipPosition="top"></button>
          </div>
        </div>
        <div class="text-sm text-600">
          <div class="flex items-center gap-2">
            <i class="pi pi-book"></i>{{ question.subject.name }}
          </div>
          <div class="flex items-center gap-2 mt-1">
            <i class="pi pi-chart-line"></i>{{ question.difficulty.name }}
          </div>
        </div>
      </div>
      }
    </div>

    <div class="flex justify-center items-center mt-8 bottom-20 inset-x-0">
      <p-paginator (onPageChange)="onPageChange($event)" [first]="(questions.page - 1) * questions.size"
        [rows]="questions.size" [totalRecords]="questions.total" [rowsPerPageOptions]="[5, 10, 15]" />
    </div>

  </div>
</div>